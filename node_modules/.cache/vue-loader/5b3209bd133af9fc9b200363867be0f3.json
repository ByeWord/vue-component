{"remainingRequest":"C:\\Users\\WeChain\\Documents\\Programs\\Vue\\vue-component\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\WeChain\\Documents\\Programs\\Vue\\vue-component\\src\\components\\slides\\src\\slides.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\WeChain\\Documents\\Programs\\Vue\\vue-component\\src\\components\\slides\\src\\slides.vue","mtime":1580794280479},{"path":"C:\\Users\\WeChain\\Documents\\Programs\\Vue\\vue-component\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\WeChain\\Documents\\Programs\\Vue\\vue-component\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\WeChain\\Documents\\Programs\\Vue\\vue-component\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\WeChain\\Documents\\Programs\\Vue\\vue-component\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiV1NsaWRlcyIsCiAgcHJvcHM6IHsKICAgIHNlbGVjdGVkOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgIH0sCiAgICBhdXRvUGxheTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRvdHNDb3VudDogMCwKICAgICAgbGFzdFNlbGVjdGVkSW5kZXg6IHVuZGVmaW5lZCwKICAgICAgdGltZUlkOiBudWxsCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy51cGRhdGVDaGlsZHJlbigpOwogICAgY29uc29sZS5sb2codGhpcy4kY2hpbGRyZW4pCiAgICB0aGlzLmF1dG9QbGF5ICYmIHRoaXMucGxheUF1dG9tYXRpY2FsbHkoKTsKICAgIHRoaXMuZG90c0NvdW50ID0gdGhpcy4kY2hpbGRyZW4ubGVuZ3RoOwogIH0sCiAgdXBkYXRlZCgpIHsKICAgIHRoaXMudXBkYXRlQ2hpbGRyZW4oKTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBuYW1lcygpIHsKICAgICAgcmV0dXJuIHRoaXMuJGNoaWxkcmVuLm1hcChjaGlsZCA9PiBjaGlsZC5uYW1lKTsKICAgIH0sCiAgICBzZWxlY3RlZEluZGV4KCkgewogICAgICBsZXQgaW5kZXggPSB0aGlzLm5hbWVzLmluZGV4T2YodGhpcy5zZWxlY3RlZCk7CiAgICAgIHJldHVybiBpbmRleCA9PT0gLTEgPyAwIDogaW5kZXg7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBvblRvdWNoU3RhcnQoZSkgewogICAgICBpZiAoZS50b3VjaGVzLmxlbmd0aCA+IDEpIHJldHVybjsKICAgICAgdGhpcy5wYXVzZSgpOwogICAgfSwKICAgIG9uVG91Y2hNb3ZlKGUpIHsKICAgICAgY29uc29sZS5sb2coJ29uVG91Y2hNb3ZlJykKICAgIH0sCiAgICBvblRvdWNoRW5kKGUpIHsKICAgICAgbGV0IGVuZFRvdWNoID0gZS5jaGFuZ2VkVG91Y2hlc1swXTsKICAgICAgY29uc29sZS5sb2coZW5kVG91Y2gpCiAgICB9LAogICAgdXBkYXRlQ2hpbGRyZW4oKSB7IC8vIOaguOW/g+abtOaWsOaWueazlQogICAgICBsZXQgc2VsZWN0ZWQgPSB0aGlzLmdldFNlbGVjdGVkKCk7IC8vIOiOt+WPluabtOaWsOWQjueahHNlbGVjdGVkCiAgICAgIHRoaXMuJGNoaWxkcmVuLmZvckVhY2godm0gPT4gewogICAgICAgIC8vIFZ1ZeeahOW8guatpeabtOaWsO+8jOWvvOiHtGRvbeaTjeS9nHJldmVyc2Xnsbvmm7TmlrDkuI3lj4rml7YKICAgICAgICBsZXQgcmV2ZXJzZSA9IHRoaXMuc2VsZWN0ZWRJbmRleCA8PSB0aGlzLmxhc3RTZWxlY3RlZEluZGV4OwogICAgICAgIGlmICh0aGlzLnRpbWVJZCkgewogICAgICAgICAgaWYgKHRoaXMubGFzdFNlbGVjdGVkSW5kZXggPT09IHRoaXMuJGNoaWxkcmVuLmxlbmd0aCAtIDEpIHsKICAgICAgICAgICAgcmV2ZXJzZSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2bS5yZXZlcnNlID0gcmV2ZXJzZTsKICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICB2bS5zZWxlY3RlZCA9IHNlbGVjdGVkOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRTZWxlY3RlZCgpIHsKICAgICAgbGV0IGZpcnN0ID0gdGhpcy4kY2hpbGRyZW5bMF07CiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkIHx8IGZpcnN0Lm5hbWU7CiAgICB9LAogICAgb25Nb3VzZUxlYXZlKCkgewogICAgICBpZiAoIXRoaXMudGltZUlkKSB7IC8v5Li65LqG6Ziy5q2idGltZUlk6KKr6YeN5aSN5pKt5pS+CiAgICAgICAgdGhpcy5wbGF5QXV0b21hdGljYWxseSgpOwogICAgICB9CiAgICB9LAogICAgcGxheUF1dG9tYXRpY2FsbHkoKSB7CiAgICAgIGxldCBwbGF5ID0gKCkgPT4gewogICAgICAgIGxldCBpbmRleCA9IHRoaXMubmFtZXMuaW5kZXhPZih0aGlzLmdldFNlbGVjdGVkKCkpOwogICAgICAgIGluZGV4ID0gKCsraW5kZXgpICUgdGhpcy5uYW1lcy5sZW5ndGg7IC8vIOato+WQkQogICAgICAgIHRoaXMuc3dpdGNoVG8oaW5kZXgpOwogICAgICAgIHRoaXMudGltZUlkID0gc2V0VGltZW91dChwbGF5LCA1MDAwKQogICAgICB9OwogICAgICBwbGF5KCk7CiAgICB9LAogICAgcGF1c2UoKSB7CiAgICAgIHRoaXMudGltZUlkICYmIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy50aW1lSWQpOwogICAgICB0aGlzLnRpbWVJZCA9IG51bGw7CiAgICB9LAogICAgc3dpdGNoVG8oaW5kZXgpIHsKICAgICAgdGhpcy5sYXN0U2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmRleDsKICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGVkJywgdGhpcy5uYW1lc1tpbmRleF0pOwogICAgfQogIH0KfQo="},{"version":3,"sources":["slides.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"slides.vue","sourceRoot":"src/components/slides/src","sourcesContent":["<template>\r\n    <div class=\"w-slides\">\r\n        <div\r\n                class=\"w-slides-window\"\r\n                ref=\"window\"\r\n                @touchstart=\"onTouchStart\"\r\n                @touchmove=\"onTouchMove\"\r\n                @touchend=\"onTouchEnd\"\r\n        >\r\n            <div class=\"w-slides-wrapper\">\r\n                <slot></slot>\r\n            </div>\r\n        </div>\r\n        <ul class=\"w-slides-dots\">\r\n            <li class=\"w-slides-dot\" :class=\"{active:selectedIndex===(n-1)}\" v-for=\"n in dotsCount\" :key=\"n\"\r\n                @click=\"switchTo(n-1)\"\r\n                @mouseenter=\"pause\"\r\n                @mouseleave=\"onMouseLeave\"\r\n            >\r\n                {{n}}\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    name: \"WSlides\",\r\n    props: {\r\n      selected: {\r\n        type: String,\r\n      },\r\n      autoPlay: {\r\n        type: Boolean,\r\n        default: true\r\n      },\r\n    },\r\n    data() {\r\n      return {\r\n        dotsCount: 0,\r\n        lastSelectedIndex: undefined,\r\n        timeId: null\r\n      }\r\n    },\r\n    mounted() {\r\n      this.updateChildren();\r\n      console.log(this.$children)\r\n      this.autoPlay && this.playAutomatically();\r\n      this.dotsCount = this.$children.length;\r\n    },\r\n    updated() {\r\n      this.updateChildren();\r\n    },\r\n    computed: {\r\n      names() {\r\n        return this.$children.map(child => child.name);\r\n      },\r\n      selectedIndex() {\r\n        let index = this.names.indexOf(this.selected);\r\n        return index === -1 ? 0 : index;\r\n      }\r\n    },\r\n    methods: {\r\n      onTouchStart(e) {\r\n        if (e.touches.length > 1) return;\r\n        this.pause();\r\n      },\r\n      onTouchMove(e) {\r\n        console.log('onTouchMove')\r\n      },\r\n      onTouchEnd(e) {\r\n        let endTouch = e.changedTouches[0];\r\n        console.log(endTouch)\r\n      },\r\n      updateChildren() { // 核心更新方法\r\n        let selected = this.getSelected(); // 获取更新后的selected\r\n        this.$children.forEach(vm => {\r\n          // Vue的异步更新，导致dom操作reverse类更新不及时\r\n          let reverse = this.selectedIndex <= this.lastSelectedIndex;\r\n          if (this.timeId) {\r\n            if (this.lastSelectedIndex === this.$children.length - 1) {\r\n              reverse = false;\r\n            }\r\n          }\r\n          vm.reverse = reverse;\r\n          this.$nextTick(() => {\r\n            vm.selected = selected;\r\n          });\r\n        });\r\n      },\r\n      getSelected() {\r\n        let first = this.$children[0];\r\n        return this.selected || first.name;\r\n      },\r\n      onMouseLeave() {\r\n        if (!this.timeId) { //为了防止timeId被重复播放\r\n          this.playAutomatically();\r\n        }\r\n      },\r\n      playAutomatically() {\r\n        let play = () => {\r\n          let index = this.names.indexOf(this.getSelected());\r\n          index = (++index) % this.names.length; // 正向\r\n          this.switchTo(index);\r\n          this.timeId = setTimeout(play, 5000)\r\n        };\r\n        play();\r\n      },\r\n      pause() {\r\n        this.timeId && window.clearTimeout(this.timeId);\r\n        this.timeId = null;\r\n      },\r\n      switchTo(index) {\r\n        this.lastSelectedIndex = this.selectedIndex;\r\n        this.$emit('update:selected', this.names[index]);\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    .w-slides {\r\n        border: 1px solid black;\r\n        position: relative;\r\n        &-window {\r\n            overflow: hidden;\r\n        }\r\n        &-wrapper {\r\n            position: relative;\r\n        }\r\n        &-dots {\r\n            padding: 0;\r\n            margin: 0;\r\n            list-style: none;\r\n            position: absolute;\r\n            border-bottom: 0;\r\n            left: 50%;\r\n            transform: translateX(-50%);\r\n        }\r\n        &-dot {\r\n            height: 16px;\r\n            width: 16px;\r\n            font-size: 12px;\r\n            cursor: pointer;\r\n            display: inline-block;\r\n            line-height: 16px;\r\n            text-align: center;\r\n            border-radius: 50%;\r\n            background-color: #cccccc;\r\n            transition: background-color 0.8s ease-in-out;\r\n            &.active {\r\n                background-color: crimson;\r\n            }\r\n            &:hover {\r\n                background-color: crimson;\r\n            }\r\n            &:not(:last-child) {\r\n                margin-right: 12px;\r\n            }\r\n        }\r\n    }\r\n</style>"]}]}